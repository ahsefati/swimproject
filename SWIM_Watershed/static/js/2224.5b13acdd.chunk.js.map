{"version":3,"file":"static/js/2224.5b13acdd.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/layers/save/featureLayerUtils.js","../node_modules/@arcgis/core/layers/support/fetchService.js","../node_modules/@arcgis/core/portal/support/jsonContext.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{difference as e}from\"../../core/arrayUtils.js\";import t from\"../../core/Error.js\";import r from\"../../core/Logger.js\";import{isNone as a,isSome as o}from\"../../core/maybe.js\";import{debounce as s,eachAlways as l}from\"../../core/promiseUtils.js\";import{updateOrigins as i}from\"../../core/accessorSupport/originUtils.js\";import n from\"../FeatureLayer.js\";import{parse as u}from\"../support/arcgisLayerUrl.js\";import{fetchFeatureService as p}from\"../support/fetchService.js\";import{isFeatureCollectionLayer as c,isFeatureServiceLayer as y}from\"../support/layerUtils.js\";import d from\"../../portal/Portal.js\";import m from\"../../portal/PortalItem.js\";import{createForItemWrite as f}from\"../../portal/support/jsonContext.js\";import{addTypeKeyword as w,TypeKeyword as h,getWGS84ExtentForItem as v,removeTypeKeyword as b}from\"../../portal/support/portalItemUtils.js\";const I=r.getLogger(\"esri.layers.FeatureLayer\"),S=\"Feature Service\";function g(e,t){return`Layer (title: ${e.title}, id: ${e.id}) of type '${e.declaredClass}' ${t}`}function j(e,r){if(r.type!==S)throw new t(\"feature-layer:portal-item-wrong-type\",g(e,`should have portal item of type \"${S}\"`))}async function L(e){if(await e.load(),c(e))throw new t(\"feature-layer:save\",g(e,\"using an in-memory source cannot be saved to a portal item\"))}function P(e,r){let a=(e.messages??[]).filter((({type:e})=>\"error\"===e)).map((({name:e,message:r,details:a})=>new t(e,r,a)));if(r?.ignoreUnsupported&&(a=a.filter((({name:e})=>\"layer:unsupported\"!==e&&\"symbol:unsupported\"!==e&&\"symbol-layer:unsupported\"!==e&&\"property:unsupported\"!==e&&\"url:unsupported\"!==e))),a.length>0)throw new t(\"feature-layer:save\",\"Failed to save feature layer due to unsupported or invalid content. See 'details.errors' for more detailed information\",{errors:a})}async function J(e,t,r){\"beforeSave\"in e&&\"function\"==typeof e.beforeSave&&await e.beforeSave();const a=e.write({},t);return P(t,r),a}function N(e){const{layer:t,layerJSON:r}=e;return t.isTable?{layers:[],tables:[r]}:{layers:[r],tables:[]}}function O(e){w(e,h.JSAPI),e.typeKeywords&&(e.typeKeywords=e.typeKeywords.filter(((e,t,r)=>r.indexOf(e)===t)))}function E(e){const r=e.portalItem;if(!r)throw I.error(\"save: requires the portalItem property to be set\"),new t(\"feature-layer:portal-item-not-set\",g(e,\"requires the portalItem property to be set\"));if(!r.loaded)throw new t(\"feature-layer:portal-item-not-loaded\",g(e,\"cannot be saved to a portal item that does not exist or is inaccessible\"));j(e,r)}async function T(e,t){return/\\/\\d+\\/?$/.test(e.url??\"\")?N(t[0]):$(e,t)}async function $(e,t){const{layer:{url:r,customParameters:a,apiKey:o}}=t[0];let s=await e.fetchData(\"json\");s&&null!=s.layers&&null!=s.tables||(s=await x(s,{url:r??\"\",customParameters:a,apiKey:o},t.map((e=>e.layer.layerId))));for(const l of t)K(l.layer,l.layerJSON,s);return s}async function x(e,t,r){var a,o;e||(e={}),(a=e).layers||(a.layers=[]),(o=e).tables||(o.tables=[]);const{url:s,customParameters:l,apiKey:i}=t,{serviceJSON:n,layersJSON:u}=await p(s,{customParameters:l,apiKey:i}),c=A(e.layers,n.layers,r),y=A(e.tables,n.tables,r);e.layers=c.itemResources,e.tables=y.itemResources;const d=[...c.added,...y.added],m=u?[...u.layers,...u.tables]:[];return await U(e,d,s,m),e}function A(t,r,a){const o=e(t,r,((e,t)=>e.id===t.id));t=t.filter((e=>!o.removed.some((t=>t.id===e.id))));const s=o.added.map((({id:e})=>({id:e})));return s.forEach((({id:e})=>{t.push({id:e})})),{itemResources:t,added:s.filter((({id:e})=>!a.includes(e)))}}async function U(e,t,r,o){const s=t.map((({id:e})=>new n({url:r,layerId:e,sourceJSON:o.find((({id:t})=>t===e))})));await l(s.map((e=>e.load()))),s.forEach((t=>{const{layerId:r,loaded:o,defaultPopupTemplate:s}=t;if(!o||a(s))return;K(t,{id:r,popupInfo:s.toJSON()},e)}))}function K(e,t,r){e.isTable?F(r.tables,t):F(r.layers,t)}function F(e,t){if(!e)return;const r=e.findIndex((({id:e})=>e===t.id));-1===r?e.push(t):e[r]=t}function R(e){const{portalItem:t}=e;return y(e)&&!e.dynamicDataSource&&!!t?.loaded&&t.type===S}async function D(e){if(!e?.length)throw new t(\"feature-layer-utils-saveall:missing-parameters\",\"'layers' array should contain at least one feature layer\");await Promise.all(e.map((e=>e.load())));for(const o of e)if(!R(o))throw new t(\"feature-layer-utils-saveall:invalid-parameters\",`'layers' array should only contain layers or tables in a feature service loaded from 'Feature Service' item. ${g(o,\"does not conform\")}`,{layer:o});const r=e.map((e=>e.portalItem.id));if(new Set(r).size>1)throw new t(\"feature-layer-utils-saveall:invalid-parameters\",\"All layers in the 'layers' array should be loaded from the same portal item\");const a=e.map((e=>e.layerId));if(new Set(a).size!==a.length)throw new t(\"feature-layer-utils-saveall:invalid-parameters\",\"'layers' array should contain only one instance each of layer or table in a feature service\")}function _(e,t){var r,a;let o=m.from(t);return o.id&&(o=o.clone(),o.id=null),(r=o).type??(r.type=S),(a=o).portal??(a.portal=d.getDefault()),j(e,o),o}async function q(e,t){const{url:r,layerId:a,title:s,fullExtent:l,isTable:i}=e,n=u(r),p=o(n)&&\"FeatureServer\"===n.serverType;t.url=p?r:`${r}/${a}`,t.title||(t.title=s),t.extent=null,!i&&o(l)&&(t.extent=await v(l)),b(t,h.METADATA),b(t,h.MULTI_LAYER),w(t,h.SINGLE_LAYER),i&&w(t,h.TABLE),O(t)}async function z(e,t,r){const a=e.portal;await(a?._signIn()),await(a?.user?.addItem({item:e,data:t,folder:r?.folder}))}const C=s(M);async function M(e,t){await L(e),E(e);const r=e.portalItem,a=f(r),o=await J(e,a,t),s=await T(r,[{layer:e,layerJSON:o}]);return O(r),await r.update({data:s}),i(a),r}const Y=s((async(e,t)=>{await D(e);const r=e[0].portalItem,a=f(r),o=await Promise.all(e.map((e=>J(e,a,t)))),s=await T(r,e.map(((e,t)=>({layer:e,layerJSON:o[t]}))));return O(r),await r.update({data:s}),await Promise.all(e.slice(1).map((e=>e.portalItem.reload()))),i(a),r.clone()})),B=s(G);async function G(e,t,r){await L(e);const a=_(e,t),o=f(a),s=N({layer:e,layerJSON:await J(e,o,r)});return await q(e,a),await z(a,s,r),e.portalItem=a,i(o),a}export{C as save,Y as saveAll,B as saveAs};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport e from\"../../request.js\";async function r(e,r){let s=await a(e,r);s=s||{},s.layers=s.layers?.filter(t)||[];const n={serviceJSON:s};if((s.currentVersion??0)<10.5)return n;const o=await a(e+\"/layers\",r);return n.layersJSON={layers:o?.layers?.filter(t)||[],tables:o?.tables||[]},n}function t(e){return!e.type||\"Feature Layer\"===e.type}async function a(r,t){return(await e(r,{responseType:\"json\",query:{f:\"json\",...t?.customParameters,token:t?.apiKey}})).data}export{r as fetchFeatureService,a as fetchService};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{urlToObject as r}from\"../../core/urlUtils.js\";import t from\"../Portal.js\";function e(e){return{origin:\"portal-item\",url:r(e.itemUrl),portal:e.portal||t.getDefault(),portalItem:e,readResourcePaths:[]}}function o(e){return{origin:\"portal-item\",messages:[],writtenProperties:[],url:e.itemUrl?r(e.itemUrl):null,portal:e.portal||t.getDefault(),portalItem:e}}export{e as createForItemRead,o as createForItemWrite};\n"],"names":["I","r","S","g","e","t","title","id","declaredClass","j","type","L","load","c","P","a","messages","filter","map","name","message","details","ignoreUnsupported","length","errors","J","beforeSave","write","N","layer","layerJSON","isTable","layers","tables","O","w","h","typeKeywords","indexOf","E","portalItem","error","loaded","T","test","url","$","customParameters","o","apiKey","fetchData","s","x","layerId","K","l","i","p","n","serviceJSON","u","layersJSON","A","y","itemResources","d","added","m","U","removed","some","forEach","push","includes","sourceJSON","find","defaultPopupTemplate","popupInfo","toJSON","F","findIndex","R","dynamicDataSource","D","Promise","all","Set","size","_","clone","portal","q","fullExtent","serverType","extent","v","b","z","_signIn","user","addItem","item","data","folder","C","f","update","Y","slice","reload","B","currentVersion","responseType","query","token","origin","itemUrl","readResourcePaths","writtenProperties"],"sourceRoot":""}